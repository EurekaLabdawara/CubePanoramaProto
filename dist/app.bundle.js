(()=>{"use strict";!function(){var e=window.Marzipano,t=window.bowser,o=window.screenfull,n=window.APP_DATA,s=document.querySelector("#pano"),i=document.querySelector("#titleBar .sceneName"),c=document.querySelector("#sceneList"),a=document.querySelectorAll("#sceneList .scene"),d=document.querySelector("#sceneListToggle"),r=document.querySelector("#autorotateToggle"),l=document.querySelector("#fullscreenToggle");if(window.matchMedia){var u=function(){m.matches?(document.body.classList.remove("desktop"),document.body.classList.add("mobile")):(document.body.classList.remove("mobile"),document.body.classList.add("desktop"))},m=matchMedia("(max-width: 500px), (max-height: 500px)");u(),m.addListener(u)}else document.body.classList.add("desktop");document.body.classList.add("no-touch"),window.addEventListener("touchstart",(function(){document.body.classList.remove("no-touch"),document.body.classList.add("touch")})),t.msie&&parseFloat(t.version)<11&&document.body.classList.add("tooltip-fallback");var h={controls:{mouseViewMode:n.settings.mouseViewMode}},p=new e.Viewer(s,h),v=n.scenes.map((function(t){var o=e.ImageUrlSource.fromString("tiles/"+t.id+"/{z}/{f}/{y}/{x}.jpg",{cubeMapPreviewUrl:"tiles/"+t.id+"/preview.jpg"}),n=new e.CubeGeometry(t.levels),s=e.RectilinearView.limit.traditional(t.faceSize,100*Math.PI/180,120*Math.PI/180),i=new e.RectilinearView(t.initialViewParameters,s),c=p.createScene({source:o,geometry:n,view:i,pinFirstLevel:!0});return t.linkHotspots.forEach((function(e){var t=function(e){var t=document.createElement("div");t.classList.add("hotspot"),t.classList.add("link-hotspot");var o=document.createElement("img");o.src="img/link.png",o.classList.add("link-hotspot-icon");for(var n=["-ms-transform","-webkit-transform","transform"],s=0;s<n.length;s++){var i=n[s];o.style[i]="rotate("+e.rotation+"rad)"}t.addEventListener("click",(function(){q(function(e){for(var t=0;t<v.length;t++)if(v[t].data.id===e)return v[t];return null}(e.target))})),P(t);var c=document.createElement("div");return c.classList.add("hotspot-tooltip"),c.classList.add("link-hotspot-tooltip"),c.innerHTML=T(e.target).name,t.appendChild(o),t.appendChild(c),t}(e);c.hotspotContainer().createHotspot(t,{yaw:e.yaw,pitch:e.pitch})})),t.infoHotspots.forEach((function(e){var t=function(e){var t=document.createElement("div");t.classList.add("hotspot"),t.classList.add("info-hotspot");var o=document.createElement("div");o.classList.add("info-hotspot-header");var n=document.createElement("div");n.classList.add("info-hotspot-icon-wrapper");var s=document.createElement("img");s.src="img/info.png",s.classList.add("info-hotspot-icon"),n.appendChild(s);var i=document.createElement("div");i.classList.add("info-hotspot-title-wrapper");var c=document.createElement("div");if(c.classList.add("info-hotspot-title"),c.innerHTML=e.title,i.appendChild(c),!e.custom){var a=document.createElement("div");a.classList.add("info-hotspot-close-wrapper");var d=document.createElement("img");d.src="img/close.png",d.classList.add("info-hotspot-close-icon"),a.appendChild(d)}if(o.appendChild(n),o.appendChild(i),e.custom||o.appendChild(a),!e.custom){var r=document.createElement("div");r.classList.add("info-hotspot-text"),r.innerHTML=e.text}t.appendChild(o),e.custom;var l=document.createElement("div");if(l.innerHTML=t.innerHTML,l.classList.add("info-hotspot-modal"),document.body.appendChild(l),e.custom){let o=document.querySelector("#modal");t.querySelector(".info-hotspot-header").addEventListener("click",(function(){switch(o.querySelector("h1").innerHTML=e.title,o.querySelectorAll(".custom-modal-content").forEach((e=>{e.hidden=!0})),e.type){case"youtube":o.querySelector("iframe").hidden=!1,o.querySelector("iframe").src=e.link;break;case"pdf":o.querySelector("#pdf-viewer").hidden=!1,o.querySelector("#pdf-viewer").setAttribute("src",e.link);break;case"image":o.querySelector("img").hidden=!1}o.showModal()})),o.querySelector(".close-custom-modal").addEventListener("click",(function(){o.querySelectorAll(".custom-modal-content").hidden=!0,o.classList.remove("hide"),o.close()}))}else{var u=function(){t.classList.toggle("visible"),l.classList.toggle("visible")};t.querySelector(".info-hotspot-header").addEventListener("click",u),l.querySelector(".info-hotspot-close-wrapper").addEventListener("click",u)}return P(t),t}(e);c.hotspotContainer().createHotspot(t,{yaw:e.yaw,pitch:e.pitch}),e.custom})),{data:t,scene:c,view:i}})),f=e.autorotate({yawSpeed:.03,targetPitch:0,targetFov:Math.PI/2});n.settings.autorotateEnabled&&r.classList.add("enabled"),r.addEventListener("click",(function(){r.classList.contains("enabled")?(r.classList.remove("enabled"),C()):(r.classList.add("enabled"),k())})),o.enabled&&n.settings.fullscreenButton?(document.body.classList.add("fullscreen-enabled"),l.addEventListener("click",(function(){o.toggle()})),o.on("change",(function(){o.isFullscreen?l.classList.add("enabled"):l.classList.remove("enabled")}))):document.body.classList.add("fullscreen-disabled"),d.addEventListener("click",(function(){c.classList.toggle("enabled"),d.classList.toggle("enabled")})),document.body.classList.contains("mobile")||(c.classList.add("enabled"),d.classList.add("enabled")),v.forEach((function(e){document.querySelector('#sceneList .scene[data-id="'+e.data.id+'"]').addEventListener("click",(function(){q(e),document.body.classList.contains("mobile")&&(c.classList.remove("enabled"),d.classList.remove("enabled"))}))}));var L=document.querySelector("#viewUp"),g=document.querySelector("#viewDown"),y=document.querySelector("#viewLeft"),w=document.querySelector("#viewRight"),b=document.querySelector("#viewIn"),E=document.querySelector("#viewOut"),M=document.querySelector("#audioBtn"),S=p.controls();function q(e){C(),e.view.setParameters(e.data.initialViewParameters),e.scene.switchTo(),k(),function(e){i.innerHTML=e.data.name.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;")}(e),function(e){for(var t=0;t<a.length;t++){var o=a[t];o.getAttribute("data-id")===e.data.id?o.classList.add("current"):o.classList.remove("current")}}(e)}function k(){r.classList.contains("enabled")&&(p.startMovement(f),p.setIdleMovement(3e3,f))}function C(){p.stopMovement(),p.setIdleMovement(1/0)}function P(e,t){t=["touchstart","touchmove","touchend","touchcancel","wheel","mousewheel"];for(var o=0;o<t.length;o++)e.addEventListener(t[o],(function(e){e.stopPropagation()}))}function T(e){for(var t=0;t<n.scenes.length;t++)if(n.scenes[t].id===e)return n.scenes[t];return null}S.registerMethod("upElement",new e.ElementPressControlMethod(L,"y",-.7,3),!0),S.registerMethod("downElement",new e.ElementPressControlMethod(g,"y",.7,3),!0),S.registerMethod("leftElement",new e.ElementPressControlMethod(y,"x",-.7,3),!0),S.registerMethod("rightElement",new e.ElementPressControlMethod(w,"x",.7,3),!0),S.registerMethod("inElement",new e.ElementPressControlMethod(b,"zoom",-.7,3),!0),S.registerMethod("outElement",new e.ElementPressControlMethod(E,"zoom",.7,3),!0),M.addEventListener("click",(function(e){document.querySelector("#BGM").muted=!document.querySelector("#BGM").muted,console.log("audio toggled")})),document.querySelector("#BGM").addEventListener("canplaythrough",(e=>{document.querySelector("#BGM").play(),console.log("audio played")})),q(v[0])}()})();